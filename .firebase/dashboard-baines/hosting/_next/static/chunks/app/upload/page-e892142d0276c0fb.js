(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{74069:function(e,a,s){Promise.resolve().then(s.bind(s,53121))},53121:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return b}});var t=s(57437),r=s(8267),l=s(2265),i=s(13287),n=s(17689),d=s(82431),c=s(48736),o=s(65302),x=s(22252);function h(e){let{onUploadComplete:a}=e,[s,r]=(0,l.useState)(!1),[h,m]=(0,l.useState)("idle"),[u,p]=(0,l.useState)(""),g=(0,l.useRef)(null),b=async e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(t){if(!t.name.toLowerCase().endsWith(".csv")){m("error"),p("Please upload a CSV file");return}r(!0),m("idle"),p("");try{let e=new FormData;e.append("file",t);let s=await fetch("/api/upload",{method:"POST",body:e}),r=await s.json();s.ok?(m("success"),p(r.message||"File uploaded and processed successfully!"),a()):(m("error"),p(r.error||"Upload failed"))}catch(e){m("error"),p("Network error. Please try again.")}finally{r(!1)}}};return(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,t.jsx)(n.Z,{className:"h-5 w-5 text-primary-600"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload New Dataset"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Upload a new CSV file to update the dashboard with fresh data. The file should have the same format as the current dataset."}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 bg-gray-50 p-3 rounded-lg",children:[(0,t.jsx)("strong",{children:"Expected format:"})," CSV file with booking data including columns for Property, Reservation #, Reservation name, Status, Agent, Source, etc."]})]}),(0,t.jsxs)("div",{onDrop:e=>{e.preventDefault();let a=e.dataTransfer.files[0];if(a&&g.current){let e=new DataTransfer;e.items.add(a),g.current.files=e.files,b({target:{files:e.files}})}},onDragOver:e=>{e.preventDefault()},className:"\n          border-2 border-dashed rounded-lg p-8 text-center transition-colors\n          ".concat("success"===h?"border-green-300 bg-green-50":"error"===h?"border-red-300 bg-red-50":"border-gray-300 hover:border-primary-400 hover:bg-primary-50","\n        "),children:[(0,t.jsx)("input",{ref:g,type:"file",accept:".csv",onChange:b,className:"hidden",disabled:s}),s?(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,t.jsx)(d.Z,{className:"h-8 w-8 text-primary-600 animate-spin"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Processing file..."})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,t.jsx)(c.Z,{className:"h-8 w-8 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("button",{onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},className:"text-primary-600 hover:text-primary-700 font-medium",children:"Click to upload"})," ","or drag and drop"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"CSV files only"})]})]})]}),u&&(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-lg flex items-center space-x-2 ".concat("success"===h?"bg-green-50 text-green-800":"error"===h?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"),children:["success"===h?(0,t.jsx)(o.Z,{className:"h-4 w-4"}):"error"===h?(0,t.jsx)(x.Z,{className:"h-4 w-4"}):null,(0,t.jsx)("span",{className:"text-sm",children:u})]}),(0,t.jsx)("div",{className:"mt-4 text-xs text-gray-500",children:(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Note:"})," Uploading a new file will replace the current dataset and reprocess all data."]})})]})}var m=s(738),u=s(5978);let p=(0,m.ZF)({apiKey:"AIzaSyD70vqTEpkDoxHrA1b0C3uJhESLti8k0uI",authDomain:"dashboard-baines.firebaseapp.com",projectId:"dashboard-baines",storageBucket:"dashboard-baines.firebasestorage.app",messagingSenderId:"490088692843",appId:"1:490088692843:web:87523298f218fa3570c52e"}),g=(0,u.ad)(p);function b(){var e,a,s;let{data:i,loading:n,lastUpdated:d}=function(){let[e,a]=(0,l.useState)(null),[s,t]=(0,l.useState)(!0),[r,i]=(0,l.useState)(null),[n,d]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e=(0,u.JU)(g,"dashboard","data"),s=(0,u.cf)(e,e=>{if(e.exists()){let s=e.data();a(s),d(s.lastUpdated||new Date().toISOString()),t(!1),i(null)}else i("No data available"),t(!1)},e=>{console.error("Error listening to Firestore:",e),i("Failed to connect to database"),t(!1)});return()=>s()},[]),{data:e,loading:s,error:r,lastUpdated:n}}();return(0,t.jsx)(r.Z,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Data Management"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Upload new datasets to update the dashboard with fresh booking data"}),(0,t.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Current Data Status"}),n?(0,t.jsx)("p",{className:"text-gray-600",children:"Loading data status..."}):i?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Total Bookings:"})," ",(null===(e=i.summary)||void 0===e?void 0:e.total_bookings)||"N/A"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Total Revenue:"})," $",(null===(s=i.summary)||void 0===s?void 0:null===(a=s.total_revenue)||void 0===a?void 0:a.toLocaleString())||"N/A"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Last Updated:"})," ",d?new Date(d).toLocaleString():"N/A"]})]}):(0,t.jsx)("p",{className:"text-red-600",children:"No data available. Please upload a CSV file."})]})]}),(0,t.jsx)(h,{onUploadComplete:()=>{setTimeout(()=>{alert("Dataset updated successfully! All pages will now show the new data.")},1e3)}}),(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Upload Process"}),(0,t.jsxs)("ol",{className:"text-sm text-blue-800 space-y-1",children:[(0,t.jsx)("li",{children:"1. Select or drag your CSV file"}),(0,t.jsx)("li",{children:"2. File is validated and saved as bookingData.csv"}),(0,t.jsx)("li",{children:"3. Python script processes the data and applies business rules"}),(0,t.jsx)("li",{children:"4. New dashboard_data.json is generated"}),(0,t.jsx)("li",{children:"5. All dashboard pages automatically refresh with new data"})]})]}),(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-yellow-900 mb-2",children:"Important Notes"}),(0,t.jsxs)("ul",{className:"text-sm text-yellow-800 space-y-1",children:[(0,t.jsx)("li",{children:"• The CSV file must have the same format as the current dataset"}),(0,t.jsx)("li",{children:"• Uploading will replace all current data"}),(0,t.jsx)("li",{children:"• Processing may take 10-30 seconds depending on file size"}),(0,t.jsx)("li",{children:"• All business rules will be applied to the new data"}),(0,t.jsx)("li",{children:"• Charts and tables will update automatically"})]})]})]})})}},8267:function(e,a,s){"use strict";s.d(a,{Z:function(){return p}});var t=s(57437),r=s(13287),l=s(99376),i=s(27648),n=s(25466),d=s(11239),c=s(70525),o=s(29202),x=s(46221),h=s(17689);let m=[{name:"Dashboard",href:"/",icon:n.Z},{name:"Performance",href:"/performance",icon:d.Z},{name:"Revenue",href:"/revenue",icon:c.Z},{name:"Sources",href:"/sources",icon:o.Z},{name:"Analysis",href:"/analysis",icon:x.Z},{name:"Upload Data",href:"/upload",icon:h.Z}];function u(){let e=(0,l.usePathname)();return(0,t.jsxs)(r.E.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:"w-64 bg-gradient-to-b from-gray-900 to-gray-800 text-white min-h-screen",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-700",children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-white",children:"Baines River Camp"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Booking Dashboard"})]}),(0,t.jsx)("nav",{className:"p-4 space-y-2",children:m.map(a=>{let s=a.icon,l=e===a.href;return(0,t.jsx)(i.default,{href:a.href,children:(0,t.jsxs)(r.E.div,{whileHover:{x:4},whileTap:{scale:.98},className:"\n                  flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors\n                  ".concat(l?"bg-primary-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white","\n                "),children:[(0,t.jsx)(s,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:a.name})]})},a.name)})}),(0,t.jsx)("div",{className:"absolute bottom-0 w-64 p-4 border-t border-gray-700",children:(0,t.jsxs)("div",{className:"text-xs text-gray-400",children:[(0,t.jsx)("p",{children:"Last Updated:"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Check dashboard"})]})})]})}function p(e){let{children:a}=e;return(0,t.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col ml-64",children:[(0,t.jsx)(r.E.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Real-time Analytics Dashboard"})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Live Data"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-primary-600",children:"\uD83D\uDCCA Dashboard Active"})]})]})})}),(0,t.jsx)("main",{className:"flex-1 p-6",children:a}),(0,t.jsx)("footer",{className:"border-t border-gray-200 bg-white py-6 px-6",children:(0,t.jsx)("div",{className:"text-center text-sm text-gray-600",children:(0,t.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Baines River Camp - Booking Dashboard"]})})})]})]})}}},function(e){e.O(0,[609,222,411,971,117,744],function(){return e(e.s=74069)}),_N_E=e.O()}]);