(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{99276:function(e,t,r){Promise.resolve().then(r.bind(r,63853))},63853:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return $}});var s=r(57437),a=r(2265),i=r(8267),n=r(30638),c=r(57501),l=r(40624),o=r(13287),d=r(31047),x=r(95252),m=r(47625),u=r(21156),h=r(56940),y=r(97059),p=r(62994),g=r(8147),f=r(22190),j=r(54061);function b(e){let{data:t}=e,[r,i]=(0,a.useState)("month"),n=(()=>{if(!(null==t?void 0:t.revenue_trends))return[];let e=new Map;return Object.entries(t.revenue_trends).forEach(t=>{let s,[a,i]=t,[n,c]=a.split("-"),l=i.revenue||0;if("year"===r){s=n;let t=e.get(s)||0;e.set(s,t+l)}else if("quarter"===r){let t=Math.ceil(parseInt(c)/3);s="".concat(n," Q").concat(t);let r=e.get(s)||0;e.set(s,r+l)}else s=a,e.set(s,l)}),Array.from(e.entries()).map(e=>{let[t,r]=e;return{period:t,revenue:r}}).sort((e,t)=>{if("year"===r)return e.period.localeCompare(t.period);if("quarter"===r){let[r,s]=e.period.split(" Q"),[a,i]=t.period.split(" Q");return r.localeCompare(a)||parseInt(s)-parseInt(i)}return e.period.localeCompare(t.period)})})(),c=n.reduce((e,t)=>e+t.revenue,0);return(0,s.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 text-primary-600"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Revenue Over Time"})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg p-1",children:["year","quarter","month"].map(e=>(0,s.jsx)("button",{onClick:()=>i(e),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(r===e?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,s.jsx)("div",{className:"mb-4 p-4 bg-gradient-to-r from-primary-50 to-blue-50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(x.Z,{className:"h-5 w-5 text-primary-600"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:["$",c.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),(0,s.jsx)(m.h,{width:"100%",height:400,children:(0,s.jsxs)(u.w,{data:n,children:[(0,s.jsx)(h.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,s.jsx)(y.K,{dataKey:"period",stroke:"#6b7280",tick:{fill:"#6b7280"},angle:-45,textAnchor:"end",height:60}),(0,s.jsx)(p.B,{stroke:"#6b7280",tick:{fill:"#6b7280"},tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,s.jsx)(g.u,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:e=>"$".concat(e.toLocaleString("en-US",{minimumFractionDigits:2}))}),(0,s.jsx)(f.D,{}),(0,s.jsx)(j.x,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:3,dot:{r:4},activeDot:{r:6},name:"Revenue"})]})})]})}var v=r(95805),k=r(97226),N=r(39763);let w=(0,N.Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);var S=r(70525),Z=r(77031),F=r(31699);function C(e){let{data:t}=e,[r,i]=(0,a.useState)("guest"),n=(null==t?void 0:t.revenue_trends)?Object.entries(t.revenue_trends).map(e=>{let[t,s]=e,a=s.revenue||0,i=s.bookings||0,n=s.bed_nights||0;return{period:t,efficiency:parseFloat(("guest"===r?i>0?a/i:0:"night"===r?n>0?a/n:0:i>0?a/i:0).toFixed(2))}}).sort((e,t)=>e.period.localeCompare(t.period)):[],c=()=>{switch(r){case"guest":return"Per Guest";case"night":return"Per Night";default:return"Per Booking"}},l=n.length>0?n.reduce((e,t)=>e+t.efficiency,0)/n.length:0;return(0,s.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(()=>{switch(r){case"guest":return(0,s.jsx)(v.Z,{className:"h-5 w-5 text-primary-600"});case"night":return(0,s.jsx)(k.Z,{className:"h-5 w-5 text-primary-600"});default:return(0,s.jsx)(w,{className:"h-5 w-5 text-primary-600"})}})(),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Revenue Efficiency"})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg p-1",children:["guest","night","booking"].map(e=>(0,s.jsx)("button",{onClick:()=>i(e),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(r===e?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"guest"===e?"Per Guest":"night"===e?"Per Night":"Per Booking"},e))})]}),(0,s.jsx)("div",{className:"mb-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(S.Z,{className:"h-5 w-5 text-green-600"}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Average ",c()]})]}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:["$",l.toLocaleString("en-US",{minimumFractionDigits:2})]})]})}),(0,s.jsx)(m.h,{width:"100%",height:400,children:(0,s.jsxs)(Z.v,{data:n,children:[(0,s.jsx)(h.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,s.jsx)(y.K,{dataKey:"period",stroke:"#6b7280",tick:{fill:"#6b7280"},angle:-45,textAnchor:"end",height:60}),(0,s.jsx)(p.B,{stroke:"#6b7280",tick:{fill:"#6b7280"},tickFormatter:e=>"$".concat(e.toFixed(0))}),(0,s.jsx)(g.u,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:e=>"$".concat(e.toLocaleString("en-US",{minimumFractionDigits:2}))}),(0,s.jsx)(f.D,{}),(0,s.jsx)(F.$,{dataKey:"efficiency",fill:"#10b981",radius:[8,8,0,0],name:c()})]})})]})}let D=(0,N.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var _=r(20407);let E=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];function M(e){let{data:t}=e,r=(null==t?void 0:t.by_agent)?Object.entries(t.by_agent).map(e=>{let[t,r]=e;return{agent:t,revenue:r.revenue||0,bookings:r.count||0}}).sort((e,t)=>t.revenue-e.revenue).slice(0,10):[],a=r.reduce((e,t)=>e+t.revenue,0);return(0,s.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(D,{className:"h-5 w-5 text-primary-600"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Top Performing Agents"})]})}),(0,s.jsx)("div",{className:"mb-4 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(S.Z,{className:"h-5 w-5 text-purple-600"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Total from Top Agents"})]}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:["$",a.toLocaleString("en-US",{minimumFractionDigits:2})]})]})}),(0,s.jsx)(m.h,{width:"100%",height:400,children:(0,s.jsxs)(Z.v,{data:r,layout:"vertical",children:[(0,s.jsx)(h.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,s.jsx)(y.K,{type:"number",stroke:"#6b7280",tick:{fill:"#6b7280"},tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,s.jsx)(p.B,{type:"category",dataKey:"agent",stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:12},width:120}),(0,s.jsx)(g.u,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(e,t)=>"revenue"===t?"$".concat(e.toLocaleString("en-US",{minimumFractionDigits:2})):e}),(0,s.jsx)(f.D,{}),(0,s.jsx)(F.$,{dataKey:"revenue",name:"Revenue",radius:[0,8,8,0],children:r.map((e,t)=>(0,s.jsx)(_.b,{fill:E[t%E.length]},"cell-".concat(t)))})]})}),(0,s.jsx)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:"Showing top 10 agents by revenue"})]})}var A=r(65606);function $(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(!0),[d,x]=(0,a.useState)(null),[m,u]=(0,a.useState)("All"),[h,y]=(0,a.useState)("All"),p=(0,l.p)();(0,a.useEffect)(()=>{g()},[p]);let g=async()=>{try{let e=await fetch("/api/data");if(!e.ok)throw Error("Failed to fetch data");let r=await e.json();t(r),o(!1)}catch(e){e instanceof Error?x(e.message):x("An unknown error occurred"),o(!1)}};if(r)return(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading performance data..."})]})})});if(d||!e)return(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-red-600 mb-4",children:"Error loading data"})})})});let f=(0,c.p)(e,m,h);return(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Performance Analysis"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Revenue trends, efficiency metrics, and agent/source performance"})]}),(0,s.jsx)(n.Z,{statusFilter:m,classFilter:h,onStatusFilterChange:u,onClassFilterChange:y}),(0,s.jsx)(b,{data:e}),(0,s.jsx)(C,{data:e}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(M,{data:e}),(0,s.jsx)(A.Z,{data:f.by_source||e.by_source})]})]})})}},31047:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},95252:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},97226:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]])},95805:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[222,163,156,710,971,117,744],function(){return e(e.s=99276)}),_N_E=e.O()}]);